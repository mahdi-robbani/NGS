dat <- read.delim("MTnice.pileup",as.is=T,comment.char="",head=F)
names(dat) <- c("CHR","POS","REF",c("depth","bases","Qscore"))
head(dat,1)
head(dat,1)
## bases for site 2 (note the [[ notation for lists)
bases[[2]]
## bases for individual 1 as a list
bases <- strsplit(dat$bases,"")
## bases for site 2 (note the [[ notation for lists)
bases[[2]]
## base on read 3 for for site 2
bases[[2]][3]
## ascii qualities for individual 1
asciiQ <- strsplit(dat$Qscore,"")
## quality values values
Q <- lapply(asciiQ,function(x) R.oo::charToInt(x) - 33 )
library(R.oo) #package with charToInt function to convert ascii to a value
## quality values values
Q <- lapply(asciiQ,function(x) R.oo::charToInt(x) - 33 )
## ascii qualities for individual 1
asciiQ <- strsplit(dat$Qscore,"")
## quality values values
Q <- lapply(asciiQ,function(x) R.oo::charToInt(x) - 33 )
library(R.oo) #package with charToInt function to convert ascii to a value
install.packages(oo)
install.packages(R.oo)
install.packages("R.oo")
library(R.oo) #package with charToInt function to convert ascii to a value
## quality values values
Q <- lapply(asciiQ,function(x) R.oo::charToInt(x) - 33 )
## quality for site 2
Q[[2]]
## qualty values for base on read 3 for site 2
Q[[2]][3]
## bases for site 2 (note the [[ notation for lists)
bases[[2]]
## bases for site 2 (note the [[ notation for lists)
bases[[2]]
## base on read 3 for for site 2
bases[[2]][3]
E <- lapply(Q, function(x) 10^(-x/10))
E[[2]][3]
Q[[2]][3]
## row 2 col 3
b_sub <- bases[[1:3]][1:5]
## row 2
bases[[2]]
## row 2
bases[[2, 3]]
## row 2
bases[[1:3]]
## row 2
bases[[c(1:3)]]
## row 2
bases[[1]][1]
## row 2
bases[[1]][2]
## row 2
bases[[1:2]][2]
## row 2
bases[[1]][2]
## row 2
bases[[1]][1:10]
## row 2 col 3
b_sub <- bases[[1]][1:10]
e_sub <- E[[1]][1:10]
e_sub
