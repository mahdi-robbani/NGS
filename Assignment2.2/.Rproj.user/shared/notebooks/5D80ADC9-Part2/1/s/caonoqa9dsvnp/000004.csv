"0","# Genotype file names"
"0","SNP_file_name = ""data/geno_ceu_chr22_strict.tab"" ; #Genotype file path"
"0","snps_location_file_name = ""data/geno_ceu_chr22_strict.pos"" ; #snp position file path"
"0","# Gene expression file names"
"0","expression_file_name = ""data/expr_ceu_chr20.tab"" ;#Expression file path"
"0","gene_location_file_name = ""data/expr_chr20.pos"" ;#gene position file path"
"0","# Only associations significant at this level will be saved"
"0","pvOutputThreshold_cis = 0; #p.value threshold for cis eqtls"
"0","pvOutputThreshold_tra = 1; #p.value threshold for trans eqtls"
"0","#Covariates file names"
"0","covariates_file_name = character();# Set to character() for no covariates"
"0","# Distance for local gene-SNP pairs"
"0","cisDist = 1e6; #Define cis distance"
"0","## Load genotype data"
"0","snps = SlicedData$new();"
"0","snps$fileDelimiter = ""\t""; # the TAB character"
"0","snps$fileOmitCharacters = ""NA""; # denote missing values;"
"0","snps$fileSkipRows = 1; # one row of column labels"
"0","snps$fileSkipColumns = 1; # one column of row labels"
"0","snps$fileSliceSize = 2000; # read file in slices of 2,000 rows"
"0","snps$LoadFile(SNP_file_name);"
"2","Rows read: 1001 done.
"
"0","## Load gene expression data"
"0","gene = SlicedData$new();"
"0","gene$fileDelimiter = ""\t""; # the TAB character"
"0","gene$fileOmitCharacters = ""NA""; # denote missing values;"
"0","gene$fileSkipRows = 1; # one row of column labels"
"0","gene$fileSkipColumns = 1; # one column of row labels"
"0","gene$fileSliceSize = 2000; # read file in slices of 2,000 rows"
"0","gene$LoadFile(expression_file_name);"
"2","Rows read: 561 done.
"
"0","#Load position files"
"0","snpspos = read.table(snps_location_file_name, header = TRUE, stringsAsFactors = FALSE);"
"0","genepos = read.table(gene_location_file_name, header = TRUE, stringsAsFactors = FALSE);"
"0","## Run the analysis"
"0","me = Matrix_eQTL_main("
"0","  snps = snps,"
"0","  gene = gene,"
"0","  output_file_name=NULL,"
"0","  pvOutputThreshold = pvOutputThreshold_tra,"
"0","  useModel = modelLINEAR,"
"0","  errorCovariance =numeric(),"
"0","  verbose = TRUE,"
"0","  output_file_name.cis = NULL, #Do not write out cis results"
"0","  pvOutputThreshold.cis = pvOutputThreshold_cis,"
"0","  snpspos = snpspos,"
"0","  genepos = genepos,"
"0","  cisDist = cisDist,"
"0","  min.pv.by.genesnp = FALSE,"
"0","  noFDRsaveMemory = FALSE,"
"0","  pvalue.hist = FALSE)"
"2","Processing covariates
"
"2","Task finished in 0.02 seconds
"
"2","Processing gene expression data (imputation, residualization)
"
"2","Task finished in 0 seconds
"
"2","Creating output file(s)
"
"2","Task finished in 0.01 seconds
"
"2","Performing eQTL analysis
"
"2","100.00% done, 561,561 eQTLs
"
"2","Task finished in 0.42 seconds
"
"2","
"
"0","trans_eqtls = me$all$eqtls[,-c(5)]"
"0","trans_eqtls[""beta_se""] = trans_eqtls[""beta""]/trans_eqtls[""statistic""]"
"0","rm(me)"
