"0","library(tidyverse)"
"2","Registered S3 methods overwritten by 'dbplyr':
  method         from
  print.tbl_lazy     
  print.tbl_sql      
"
"2","[37m-- [1mAttaching packages[22m --------------------------------------- tidyverse 1.3.0 --[39m
"
"2","[37m[32mv[37m [34mggplot2[37m 3.3.2     [32mv[37m [34mpurrr  [37m 0.3.4
[32mv[37m [34mtibble [37m 3.0.3     [32mv[37m [34mdplyr  [37m 1.0.2
[32mv[37m [34mtidyr  [37m 1.1.2     [32mv[37m [34mstringr[37m 1.4.0
[32mv[37m [34mreadr  [37m 1.3.1     [32mv[37m [34mforcats[37m 0.5.0[39m
"
"2","[37m-- [1mConflicts[22m ------------------------------------------ tidyverse_conflicts() --
[31mx[37m [34mdplyr[37m::[32mfilter()[37m masks [34mstats[37m::filter()
[31mx[37m [34mdplyr[37m::[32mlag()[37m    masks [34mstats[37m::lag()[39m
"
"0","get_geno_frequency <- function(geno, snp_mat){"
"0","  boolean_matrix <- snp_mat == geno"
"0","  count <- apply(boolean_matrix, 1, sum)"
"0","  freq <- count/dim(snps)[2]"
"0","  return (freq)"
"0","}"
"0",""
"0","get_maf <- function(snp_mat){"
"0","  genotypes <- c(0,1,2)"
"0","  #get matrix of genotype frequencies"
"0","  geno_freq <- sapply(genotypes, get_geno_frequency, snp_mat)"
"0","  colnames(geno_freq) <- genotypes"
"0","  allele_freq <- geno_freq + geno_freq[,2]/2"
"0","  allele_freq <- allele_freq[,-2]"
"0","  maf <- apply(allele_freq, 1, min)"
"0","  return (maf)"
"0","}"
"0",""
"0","pve <- function(b, b_se, maf, N){"
"0","  return("
"0","    (2*(b^2)*maf*(1-maf))/("
"0","      (2*(b^2)*maf*(1-maf)) + (b_se^2)*2*N*maf*(1-maf)"
"0","    )"
"0","  )"
"0","}"
"0",""
"0","maf_df <- data.frame(""id"" = snp_ceu_20$id, ""maf"" = get_maf(snp_ceu_20))"
"0","temp_df <- data.frame(""id"" = cis_eqtls$snps)"
"0","temp_df <- merge(temp_df, maf_df, by=""id"", all.x = T)"
"0","cis_eqtls %>% arrange(snps) -> cis_eqtls"
"0","cis_eqtls$maf <- temp_df$maf"
"0","N <- dim(snp_ceu_20)[2] - 1"
"0","cis_eqtls$pve <- pve(cis_eqtls$beta, cis_eqtls$beta_se, cis_eqtls$maf, N)"
"0","hist(cis_eqtls$pve)"
