"0","gene_t <- as.data.frame(t(gene_expr))"
"0","snps_filtered_t <- as.data.frame(t(snps_filtered))"
"0","get_lm_values <- function(expr, snps){"
"0","  model <- summary(lm(expr ~ snps))"
"0","  return(model$coefficients[2,])"
"0","}"
"0","lm_matrix <- mapply(get_values, gene_t, snps_filtered_t)"
"0","lm_matrix <- as.data.frame(t(lm_matrix))"
"0","lm_matrix$gene_id <- rownames(lm_matrix)"
"0","lm_matrix$snp_id <- colnames(snps_filtered_t)"
"0","rownames(lm_matrix) <- NULL"
"0","lm_matrix <- lm_matrix[,c(5,6,1,3,4)]"
"0","colnames(lm_matrix) <- c(""gene_id"", ""snp_id"", ""effect_size"", ""t.value"", ""p.value"")"
"0","head(lm_matrix)"
