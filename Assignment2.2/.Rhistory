knitr::opts_chunk$set(echo = TRUE)
snps <- read.table("sub_geno.tab")
missing_count <- apply((snps == -1), 1, sum)
head(missing_count)
get_geno_frequency <- function(geno, snp_mat){
boolean_matrix <- snp_mat == geno
count <- apply(boolean_matrix, 1, sum)
freq <- count/dim(snps)[2]
return (freq)
}
get_maf <- function(snp_mat){
genotypes <- c(0,1,2)
#get matrix of genotype frequencies
geno_freq <- sapply(genotypes, get_geno_frequency, snp_mat)
colnames(geno_freq) <- genotypes
allele_freq <- geno_freq + geno_freq[,2]/2
allele_freq <- allele_freq[,-2]
maf <- apply(allele_freq, 1, min)
return (maf)
}
maf <- get_maf(snps)
head(maf)
keep <- maf >= 0.05 & missing_count == 0
snps_filtered <- snps[keep,]
dim(snps_filtered)
design <- read.table("design.tab", header = T, sep = "\t")
filter_snp_population <- function(pop, snp_mat, design_mat, inv=F){
if(inv){
cols <- design_mat$Source.Name[design_mat$Characteristics.population. != pop]
} else{
cols <- design_mat$Source.Name[design_mat$Characteristics.population. == pop]
}
snp_mat <- (snp_mat[, cols])
return(snp_mat)
}
african_snps <- filter_snp_population("YRI", snps_filtered, design)
non_african_snps <- filter_snp_population("YRI", snps_filtered, design, inv = T)
african_maf <- get_maf(african_snps)
non_african_maf <- get_maf(non_african_snps)
print("African")
print(head(african_maf))
print("Non-African")
print(head(non_african_maf))
# library(tidyverse)
# gene_expr <- read.table("sub_expr.tab")
# head(gene_expr)
# gene1 <- c("ENSG00000172404.4")
# gene_expr %>%
#   t %>%
#   as_tibble() %>%
#   #rownames_to_column("Gene") %>%
#   select(ENSG00000172404.4) %>%
#   #select(-Gene) %>%
#   ggplot(aes(x=ENSG00000172404.4)) + geom_histogram()
hist(as.matrix(gene_expr[gene1,]))
# library(tidyverse)
gene_expr <- read.table("sub_expr.tab")
# head(gene_expr)
# gene1 <- c("ENSG00000172404.4")
# gene_expr %>%
#   t %>%
#   as_tibble() %>%
#   #rownames_to_column("Gene") %>%
#   select(ENSG00000172404.4) %>%
#   #select(-Gene) %>%
#   ggplot(aes(x=ENSG00000172404.4)) + geom_histogram()
hist(as.matrix(gene_expr[gene1,]))
# library(tidyverse)
gene_expr <- read.table("sub_expr.tab")
# head(gene_expr)
gene1 <- c("ENSG00000172404.4")
# gene_expr %>%
#   t %>%
#   as_tibble() %>%
#   #rownames_to_column("Gene") %>%
#   select(ENSG00000172404.4) %>%
#   #select(-Gene) %>%
#   ggplot(aes(x=ENSG00000172404.4)) + geom_histogram()
hist(as.matrix(gene_expr["ENSG00000172404.4",]))
# library(tidyverse)
gene_expr <- read.table("sub_expr.tab")
gene1 <- c("ENSG00000172404.4")
# gene_expr %>%
#   t %>%
#   as_tibble() %>%
#   #rownames_to_column("Gene") %>%
#   select(ENSG00000172404.4) %>%
#   #select(-Gene) %>%
#   ggplot(aes(x=ENSG00000172404.4)) + geom_histogram()
hist(as.matrix(gene_expr[gene1,]), main=gene1, xlab="Gene Expression Level")
View(gene_expr)
View(gene_expr)
View(african_snps)
View(african_snps)
View(snps)
View(snps)
library(tidyverse)
gene_expr
head(gene_expr)
gene_expr[gene1,]
geneLong <- melt(expr[gene1,])
library(tidyverse)
snps <- c("snp_22_41256802", "snp_22_45782142")
geneLong <- melt(expr[gene1,])
snps_filtered %>%
head
head(snp_filtered)
s
head(snps_filtered)
snps_filtered %>%
filter(snps) %>%
n()
snps1 <- c("snp_22_41256802", "snp_22_45782142")
snps_filtered %>%
filter(snps1) %>%
n()
View(snps_filtered)
View(snps_filtered)
snps[snps1,]
snps_filtered[snps1,]
snps_filtered[snps1,]
t(snps_filtered[snps1,])
t(snps_filtered[snps1,]) %>% head
t(snps_filtered[snps1,]) %>% dim
gene_expr %>% head
gene_expr[gene1,] %>% head
t(gene_expr[gene1,]) %>% head
t(gene_expr[gene1,]) %>% dim
t(snps_filtered[snps1,]) %>% dim
t(gene_expr[gene1,]) %>% dim
t(snps_filtered[snps1,]) %>% head
df <- cbind(snps1_col, gene1_col)
gene1_col <- t(gene_expr[gene1,])
snps1_col <- t(snps_filtered[snps1,])
df <- cbind(snps1_col, gene1_col)
df %>% head
colnames(df) <- c(snps1, "expression")
df %>%
gather(-expression, "SNP", "genotype") %>%
head
df %>%
as.tiblle %>%
gather(-expression, "SNP", "genotype") %>%
head
df %>%
as.tibble %>%
gather(-expression, "SNP", "genotype") %>%
head
df %>%
as_tibble %>%
gather(-expression, "SNP", "genotype") %>%
head
df %>%
as_tibble %>%
gather(-expression, key="SNP", value ="genotype") %>%
head
library(tidyverse)
snps1 <- c("snp_22_41256802", "snp_22_45782142")
gene1_col <- t(gene_expr[gene1,])
snps1_col <- t(snps_filtered[snps1,])
df <- cbind(snps1_col, gene1_col)
colnames(df) <- c(snps1, "expression")
df %>%
as_tibble %>%
gather(-expression, key="SNP", value ="genotype") %>%
ggplot(aes(x=genotype, y=expression)) + geom_boxplot() +
facet_wrap(~snp)
library(tidyverse)
snps1 <- c("snp_22_41256802", "snp_22_45782142")
gene1_col <- t(gene_expr[gene1,])
snps1_col <- t(snps_filtered[snps1,])
df <- cbind(snps1_col, gene1_col)
colnames(df) <- c(snps1, "expression")
df %>%
as_tibble %>%
gather(-expression, key="SNP", value ="genotype") %>%
ggplot(aes(x=genotype, y=expression)) + geom_boxplot() +
facet_wrap(~SNP)
df <- df %>%
as_tibble %>%
gather(-expression, key="SNP", value ="genotype")
library(tidyverse)
snps1 <- c("snp_22_41256802", "snp_22_45782142")
gene1_col <- t(gene_expr[gene1,])
snps1_col <- t(snps_filtered[snps1,])
df <- cbind(snps1_col, gene1_col)
colnames(df) <- c(snps1, "expression")
df <- df %>%
as_tibble %>%
gather(-expression, key="SNP", value ="genotype")
df$genotype <- as.factor(df$genotype)
df %>%
ggplot(aes(x=genotype, y=expression)) + geom_boxplot() +
facet_wrap(~SNP)
gene_expr %>% head
gene_expr %>% t %>% head
snps_filtered %>% t %>% head
gene1_col
snps1_col %>% head
snps1_col[1] %>% head
snps1_col[,1] %>% head
lm_snp_a <- lm(gene1_col, snps1_col[,1])
lm_snp_a <- lm(gene1_col ~ snps1_col[,1])
summary(lm_snp_a)
lm_snp_b <- lm(gene1_col ~ snps1_col[,2])
summary(lm_snp_b)
lm_snp_b <- lm(gene1_col ~ snps1_col[,2])
summary(lm_snp_b)
knitr::opts_chunk$set(echo = TRUE)
snps <- read.table("sub_geno.tab")
snps <- read.table("sub_geno.tab")
missing_count <- apply((snps == -1), 1, sum)
head(missing_count)
get_geno_frequency <- function(geno, snp_mat){
boolean_matrix <- snp_mat == geno
count <- apply(boolean_matrix, 1, sum)
freq <- count/dim(snps)[2]
return (freq)
}
get_maf <- function(snp_mat){
genotypes <- c(0,1,2)
#get matrix of genotype frequencies
geno_freq <- sapply(genotypes, get_geno_frequency, snp_mat)
colnames(geno_freq) <- genotypes
allele_freq <- geno_freq + geno_freq[,2]/2
allele_freq <- allele_freq[,-2]
maf <- apply(allele_freq, 1, min)
return (maf)
}
maf <- get_maf(snps)
head(maf)
keep <- maf >= 0.05 & missing_count == 0
snps_filtered <- snps[keep,]
dim(snps_filtered)
design <- read.table("design.tab", header = T, sep = "\t")
filter_snp_population <- function(pop, snp_mat, design_mat, inv=F){
if(inv){
cols <- design_mat$Source.Name[design_mat$Characteristics.population. != pop]
} else{
cols <- design_mat$Source.Name[design_mat$Characteristics.population. == pop]
}
snp_mat <- (snp_mat[, cols])
return(snp_mat)
}
african_snps <- filter_snp_population("YRI", snps_filtered, design)
non_african_snps <- filter_snp_population("YRI", snps_filtered, design, inv = T)
african_maf <- get_maf(african_snps)
non_african_maf <- get_maf(non_african_snps)
print("African")
print(head(african_maf))
print("Non-African")
print(head(non_african_maf))
gene_expr <- read.table("sub_expr.tab")
gene1 <- c("ENSG00000172404.4")
hist(as.matrix(gene_expr[gene1,]), main=gene1, xlab="Gene Expression Level")
library(tidyverse)
snps1 <- c("snp_22_41256802", "snp_22_45782142")
gene1_col <- t(gene_expr[gene1,])
snps1_col <- t(snps_filtered[snps1,])
df <- cbind(snps1_col, gene1_col)
colnames(df) <- c(snps1, "expression")
df <- df %>%
as_tibble %>%
gather(-expression, key="SNP", value ="genotype")
df$genotype <- as.factor(df$genotype)
df %>%
ggplot(aes(x=genotype, y=expression)) + geom_boxplot() +
facet_wrap(~SNP)
lm_snp_a <- lm(gene1_col ~ snps1_col[,1])
summary(lm_snp_a)
lm_snp_b <- lm(gene1_col ~ snps1_col[,2])
summary(lm_snp_b)
snps_filtered %>% head
head(snps_filtered)
head(t(snps_filtered))
snps_filtered[snp2,]
knitr::opts_chunk$set(echo = TRUE)
gene2 <- "ENSG00000100266.11"
snp2 <- "snp_22_43336231"
snps_filtered[snp2,]
gene2_row <- gene_expr[gene2,]
View(gene2_row)
View(gene2_row)
gene2 <- "ENSG00000100266.11"
snp2 <- "snp_22_43336231"
gene2_row <- gene_expr[gene2,]
lm_no_cov <- lm(gene2_row)
gene2 <- "ENSG00000100266.11"
snp2 <- "snp_22_43336231"
gene2_row <- gene_expr[gene2,]
lm_no_cov <- lm(gene2_row)
summary(lm_no_cov)
rm(gene2_row)
gene2_col <- t(gene_expr)[,gene2]
lm_no_cov <- lm(gene2_col)
t(gene_expr)[,gene2]
t(gene_expr)#[,gene2]
t(gene_expr)[,gene2]
lm_no_cov <- lm(gene2_col ~ gene2_snp)
gene2_snp <- t(snps_filtered)[,snp2]
lm_no_cov <- lm(gene2_col ~ gene2_snp)
summary(lm_no_cov)
