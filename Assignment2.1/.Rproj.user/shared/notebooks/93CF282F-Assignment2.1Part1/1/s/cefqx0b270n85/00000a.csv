"0","ind2 <- 3"
"0","lik_3 <- get_columns(likelihoods, ind2)"
"0","true2 <- genotypes$NA19663"
"0","#get predictions and posteriors for 3 pops"
"0","get_pred_maxpost <- function(pop, lik, true){"
"0","  prior <- get_genotype_freq(pop)"
"0","  post <- get_posterior(lik, prior)"
"0","  max_post <- apply(post, 1, max)"
"0","  pred <- get_predictions(post, max_post, true)"
"0","  return(list(pred, max_post))"
"0","}"
"0","list_3_pops <- lapply(freq, get_pred_maxpost, lik_3, true2)"
"0","#get predictions and posteriors for combined pop"
"0","admix <- read.table(""assign3.qopt"")"
"0","admix_3 <- admix[3,]"
"0","prior_combined <- (admix_3$V1 * get_genotype_freq(freq$V1)) +"
"0","  (admix_3$V2 * get_genotype_freq(freq$V2)) +"
"0","  (admix_3$V3 * get_genotype_freq(freq$V3))"
"0","posterior_combined <- get_posterior(lik_3, prior_combined)"
"0","called_geno_comb <- apply(posterior_combined, 1, max)"
"0","pred_comb <- get_predictions(posterior_combined, called_geno_comb, true2)"
"0","# plot"
"0","plot(1,xlim=0:1,ylim=c(0,0.40),col=""transparent"",xlab=""callrate"",ylab=""error rate"")"
